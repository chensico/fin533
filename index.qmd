---
title: "Buy Low / Sell High Strategy Optimization"
authors: "Sicong Chen, Yuxin Wan"
format:
  html:
    toc: true
    toc-depth: 3
    toc-location: left
    theme: cosmo
    code-fold: true
    highlight-style: github
    css: styles.css
    page-layout: full
    html-math-method: katex
---

::: {.content-visible when-format="html"}
```{=html}
<div style="text-align:center;margin-bottom:1.5rem;">
  <a href="https://github.com/chensico/fin533" target="_blank" class="btn btn-primary" style="text-decoration:none;background-color:#0366d6;color:white;padding:8px 16px;border-radius:6px;font-weight:600;display:inline-flex;align-items:center;">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" style="margin-right:8px;" viewBox="0 0 16 16">
      <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
    </svg>
    View Source Code on GitHub
  </a>
</div>

<style>
/* Base font size increase */
html {
  font-size: 17px;
}

body {
  font-family: 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
  line-height: 1.6;
}

/* Headers */
h1, h2, h3 {
  font-weight: 600;
}

h2 {
  font-size: 1.85rem;
  margin-top: 2rem;
}

h3 {
  font-size: 1.5rem;
}

/* Tables */
table {
  font-size: 0.95rem;
}

thead th {
  font-size: 1rem;
}

/* Formula text */
.formula-container {
  font-size: 1.1rem;
}

.custom-callout {
  padding: 0.8rem;
  margin-top: 0.8rem;
  margin-bottom: 1rem;
  border: 1px solid #ebeef2;
  border-left-width: 3px;
  border-left-color: #a2c3e0;
  border-radius: 0.2rem;
  background-color: #fbfbfd;
}

.custom-callout h3 {
  color: #4a7aa7;
  margin-top: 0;
  font-size: 1rem;
  font-weight: 500;
  margin-bottom: 0.3rem;
}

.card {
  border: 1px solid #e9ecef;
  border-radius: 0.5rem;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  background-color: white;
  transition: transform 0.3s ease;
}

.card:hover {
  transform: translateY(-5px);
}

.section-card {
  background-color: #f8f9fa;
  border-radius: 0.5rem;
  padding: 2rem;
  margin-bottom: 2rem;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
}

/* Enhanced image styling */
.image-container {
  margin: 1.5rem 0;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
  border-radius: 0.5rem;
  overflow: hidden;
  background-color: white;
}

.image-container img {
  width: 100%;
  display: block;
}

.image-caption {
  padding: 1rem 1.5rem;
  background-color: #f8f9fa;
  border-top: 1px solid #e9ecef;
  font-style: italic;
  color: #495057;
  font-size: 1rem;
  line-height: 1.5;
}

/* Enhanced table styling */
table {
  width: 100%;
  border-collapse: collapse;
  margin: 1.5rem 0;
  border-radius: 0.5rem;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

thead th {
  background-color: #eaf2f8;
  color: #2c3e50;
  font-weight: 600;
  text-align: center;
}

tbody tr:nth-child(even) {
  background-color: #f8f9fa;
}

tbody tr:hover {
  background-color: #e9f2fb;
}

.positive-value {
  color: #28a745;
  font-weight: 500;
}

.negative-value {
  color: #dc3545;
  font-weight: 500;
}

.neutral-value {
  color: #6c757d;
}

/* Section titles */
.section-title {
  margin-bottom: 1rem;
  padding-bottom: 0.5rem;
  color: #2c3e50;
  text-align: center;
  font-weight: 600;
  border-bottom: 2px solid #eaf2f8;
  font-size: 1.4rem;
}

/* Main content width */
.quarto-container {
  max-width: 1400px;
  margin: 0 auto;
}

.content-block {
  padding: 0 2rem;
}

/* Formula styling */
.formula-container {
  background-color: #f8f9fa;
  padding: 1rem 1.5rem;
  border-radius: 0.5rem;
  margin: 1.5rem 0;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
  text-align: center;
}

.formula-title {
  font-weight: 600;
  color: #2c3e50;
  margin-bottom: 0.5rem;
  font-size: 1.1rem;
}

/* List styling */
ul, ol {
  font-size: 1.05rem;
  padding-left: 1.5rem;
}

/* Panel styling */
.panel-tabset .tab-content {
  font-size: 1.02rem;
}

/* Callout text */
.callout {
  font-size: 1.05rem;
}

.callout-body {
  font-size: 1.02rem;
}

/* Collapsible callout styling */
.callout.toggleable {
  transition: all 0.3s ease;
}

.callout.toggleable .callout-header {
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.callout.toggleable .callout-header::after {
  content: "▼";
  font-size: 0.8rem;
  transition: transform 0.3s ease;
}

.callout.toggleable.collapsed .callout-header::after {
  transform: rotate(-90deg);
}

.callout.toggleable .callout-body {
  overflow: hidden;
  transition: max-height 0.5s ease, opacity 0.5s ease;
  max-height: 1000px;
  opacity: 1;
}

.callout.toggleable.collapsed .callout-body {
  max-height: 0;
  opacity: 0;
  padding-top: 0;
  padding-bottom: 0;
  margin-top: 0;
  margin-bottom: 0;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Make all callouts toggleable
  const callouts = document.querySelectorAll('.callout');
  callouts.forEach(callout => {
    // Add toggleable class
    callout.classList.add('toggleable');

    // Get the header
    const header = callout.querySelector('.callout-header');
    if (header) {
      // Add click event
      header.addEventListener('click', function() {
        callout.classList.toggle('collapsed');
      });
    }
  });
});
</script>
```
:::

## Strategy Overview {.unnumbered .center}

::: {.callout-note appearance="simple"}
This document presents the backtesting results and parameter optimization analysis for the "Buy Low Sell High" trading strategy applied to AAPL stock.
:::

::: {.section-card}
## Trading Performance {.section-title}

::: {.custom-callout style="padding:0.8rem;margin-top:0.8rem;margin-bottom:1rem;"}
### Interactive Dashboard
Explore the trading history with price movements, individual trades, and performance metrics.
:::

```{=html}
<div id="tradingDashboard" style="width:100%;background:#f8f9fa;border-radius:6px;padding:16px;box-shadow:0 2px 8px rgba(0,0,0,0.05);">
  <div style="margin-bottom:10px;display:flex;justify-content:space-between;align-items:center;">
    <h3 style="margin:0;color:#2c3e50;font-size:16px;font-weight:500;">AAPL Trading Performance</h3>
    <div style="font-size:12px;color:#6c757d;">Interactive Chart</div>
  </div>
  <div id="tradingChart" style="width:100%;height:500px;margin-bottom:10px;border-radius:4px;overflow:hidden;"></div>
  <div style="display:flex;flex-wrap:wrap;justify-content:space-between;gap:12px;">
    <div style="flex:1;min-width:280px;background:white;padding:12px;border-radius:6px;box-shadow:0 1px 4px rgba(0,0,0,0.04);">
      <h4 style="margin-top:0;margin-bottom:8px;color:#2c3e50;font-size:14px;font-weight:500;border-bottom:1px solid #eaf2f8;padding-bottom:6px;">Strategy Summary</h4>
      <div id="summaryStat" style="font-size:13px;line-height:1.5;"></div>
    </div>
    <div style="flex:1;min-width:280px;background:white;padding:12px;border-radius:6px;box-shadow:0 1px 4px rgba(0,0,0,0.04);">
      <h4 style="margin-top:0;margin-bottom:8px;color:#2c3e50;font-size:14px;font-weight:500;border-bottom:1px solid #eaf2f8;padding-bottom:6px;">Best & Worst Trades</h4>
      <div id="extremeTrades" style="font-size:13px;line-height:1.5;"></div>
    </div>
  </div>
</div>

<script src="https://cdn.plot.ly/plotly-2.29.1.min.js"></script>

<script>
(function() {
  // Embed a rich subset of the trade data directly
  const backtest_data = {
    "symbol": "AAPL",
    "backtest_summary": {
      "start_date": "2023-04-19",
      "end_date": "2025-04-17",
      "initial_value": 100000.0,
      "final_value": 112884.63,
      "total_return_pct": 12.88,
      "total_trades": 222,
      "winning_trades": 123
    },
    // Selected trades from different time periods and performance levels
    "trades": [
      // Starting period trades
      {"Entry_Date":"2023-05-16","Exit_Date":"2023-05-17","Entry_Price":171.71,"Exit_Price":172.69,"Profit":142.68,"Return":0.0057,"Duration":1,"Exit_Reason":"Unknown"},
      {"Entry_Date":"2023-05-18","Exit_Date":"2023-05-19","Entry_Price":176.11,"Exit_Price":175.16,"Profit":-135.05,"Return":-0.0054,"Duration":1,"Exit_Reason":"Unknown"},
      {"Entry_Date":"2023-05-22","Exit_Date":"2023-05-23","Entry_Price":173.13,"Exit_Price":171.56,"Profit":-226.73,"Return":-0.0091,"Duration":1,"Exit_Reason":"Unknown"},
      {"Entry_Date":"2023-05-31","Exit_Date":"2023-06-01","Entry_Price":177.70,"Exit_Price":180.09,"Profit":335.89,"Return":0.0134,"Duration":1,"Exit_Reason":"RSI_Overbought"},
      {"Entry_Date":"2023-06-02","Exit_Date":"2023-06-05","Entry_Price":182.63,"Exit_Price":179.58,"Profit":-418.48,"Return":-0.0167,"Duration":3,"Exit_Reason":"Unknown"},
      {"Entry_Date":"2023-06-14","Exit_Date":"2023-06-15","Entry_Price":183.98,"Exit_Price":186.01,"Profit":275.07,"Return":0.0110,"Duration":1,"Exit_Reason":"RSI_Overbought"},
      {"Entry_Date":"2023-06-21","Exit_Date":"2023-06-22","Entry_Price":183.74,"Exit_Price":187.00,"Profit":443.90,"Return":0.0177,"Duration":1,"Exit_Reason":"RSI_Overbought"},
      {"Entry_Date":"2023-06-29","Exit_Date":"2023-06-30","Entry_Price":191.63,"Exit_Price":193.97,"Profit":306.76,"Return":0.0122,"Duration":1,"Exit_Reason":"RSI_Overbought"},
      {"Entry_Date":"2023-07-14","Exit_Date":"2023-07-17","Entry_Price":190.69,"Exit_Price":193.99,"Profit":431.81,"Return":0.0173,"Duration":3,"Exit_Reason":"RSI_Overbought"},
      // Mid-period trades
      {"Entry_Date":"2023-09-06","Exit_Date":"2023-09-07","Entry_Price":178.69,"Exit_Price":177.56,"Profit":-159.08,"Return":-0.0063,"Duration":1,"Exit_Reason":"SMA_Breakdown"},
      {"Entry_Date":"2023-09-26","Exit_Date":"2023-09-27","Entry_Price":172.62,"Exit_Price":170.43,"Profit":-316.77,"Return":-0.0127,"Duration":1,"Exit_Reason":"SMA_Breakdown"},
      {"Entry_Date":"2023-10-06","Exit_Date":"2023-10-09","Entry_Price":176.80,"Exit_Price":178.99,"Profit":308.51,"Return":0.0124,"Duration":3,"Exit_Reason":"SMA_Breakdown"},
      {"Entry_Date":"2023-11-03","Exit_Date":"2023-11-06","Entry_Price":176.36,"Exit_Price":179.23,"Profit":409.66,"Return":0.0163,"Duration":3,"Exit_Reason":"Unknown"},
      {"Entry_Date":"2023-12-14","Exit_Date":"2023-12-15","Entry_Price":197.48,"Exit_Price":198.11,"Profit":79.84,"Return":0.0032,"Duration":1,"Exit_Reason":"SMA_Breakdown"},
      {"Entry_Date":"2024-01-16","Exit_Date":"2024-01-17","Entry_Price":183.63,"Exit_Price":188.63,"Profit":681.90,"Return":0.0272,"Duration":1,"Exit_Reason":"SMA_Breakdown"},
      {"Entry_Date":"2024-02-01","Exit_Date":"2024-02-02","Entry_Price":179.87,"Exit_Price":185.85,"Profit":851.60,"Return":0.0332,"Duration":1,"Exit_Reason":"SMA_Breakdown"},
      {"Entry_Date":"2024-04-30","Exit_Date":"2024-05-01","Entry_Price":174.01,"Exit_Price":173.45,"Profit":-80.00,"Return":-0.0032,"Duration":1,"Exit_Reason":"SMA_Breakdown"},
      {"Entry_Date":"2024-06-10","Exit_Date":"2024-06-11","Entry_Price":193.69,"Exit_Price":207.15,"Profit":1771.77,"Return":0.0695,"Duration":1,"Exit_Reason":"RSI_Overbought"},
      {"Entry_Date":"2024-07-09","Exit_Date":"2024-07-10","Entry_Price":224.21,"Exit_Price":226.34,"Profit":265.08,"Return":0.0095,"Duration":1,"Exit_Reason":"Unknown"},
      {"Entry_Date":"2024-08-02","Exit_Date":"2024-08-05","Entry_Price":199.09,"Exit_Price":209.27,"Profit":1298.92,"Return":0.0511,"Duration":3,"Exit_Reason":"SMA_Breakdown"},
      // End-period trades including the most profitable ones
      {"Entry_Date":"2024-12-04","Exit_Date":"2024-12-05","Entry_Price":203.76,"Exit_Price":202.46,"Profit":-169.67,"Return":-0.0064,"Duration":1,"Exit_Reason":"SMA_Breakdown"},
      {"Entry_Date":"2025-01-24","Exit_Date":"2025-01-27","Entry_Price":219.70,"Exit_Price":224.37,"Profit":599.97,"Return":0.0213,"Duration":3,"Exit_Reason":"SMA_Breakdown"},
      {"Entry_Date":"2025-01-27","Exit_Date":"2025-01-28","Entry_Price":230.84,"Exit_Price":238.26,"Profit":854.12,"Return":0.0321,"Duration":1,"Exit_Reason":"SMA_Breakdown"},
      {"Entry_Date":"2025-02-10","Exit_Date":"2025-02-11","Entry_Price":228.20,"Exit_Price":232.62,"Profit":516.59,"Return":0.0194,"Duration":1,"Exit_Reason":"SMA_Breakdown"},
      {"Entry_Date":"2025-02-27","Exit_Date":"2025-02-28","Entry_Price":236.98,"Exit_Price":241.84,"Profit":551.71,"Return":0.0205,"Duration":1,"Exit_Reason":"Unknown"},
      {"Entry_Date":"2025-03-07","Exit_Date":"2025-03-10","Entry_Price":235.54,"Exit_Price":227.48,"Profit":-924.44,"Return":-0.0342,"Duration":3,"Exit_Reason":"SMA_Breakdown"},
      {"Entry_Date":"2025-03-13","Exit_Date":"2025-03-14","Entry_Price":211.25,"Exit_Price":213.49,"Profit":282.99,"Return":0.0106,"Duration":1,"Exit_Reason":"SMA_Breakdown"},
      {"Entry_Date":"2025-03-27","Exit_Date":"2025-03-28","Entry_Price":221.73,"Exit_Price":217.90,"Profit":-460.36,"Return":-0.0173,"Duration":1,"Exit_Reason":"SMA_Breakdown"},
      {"Entry_Date":"2025-03-31","Exit_Date":"2025-04-01","Entry_Price":219.87,"Exit_Price":223.19,"Profit":400.69,"Return":0.0151,"Duration":1,"Exit_Reason":"SMA_Breakdown"},
      {"Entry_Date":"2025-04-04","Exit_Date":"2025-04-07","Entry_Price":177.21,"Exit_Price":181.46,"Profit":637.00,"Return":0.0240,"Duration":3,"Exit_Reason":"SMA_Breakdown"},
      {"Entry_Date":"2025-04-08","Exit_Date":"2025-04-09","Entry_Price":172.06,"Exit_Price":198.85,"Profit":4160.32,"Return":0.1557,"Duration":1,"Exit_Reason":"SMA_Breakdown"},
      {"Entry_Date":"2025-04-10","Exit_Date":"2025-04-11","Entry_Price":186.10,"Exit_Price":198.15,"Profit":1797.46,"Return":0.0648,"Duration":1,"Exit_Reason":"SMA_Breakdown"},
      {"Entry_Date":"2025-04-14","Exit_Date":"2025-04-15","Entry_Price":201.76,"Exit_Price":202.14,"Profit":53.13,"Return":0.0019,"Duration":1,"Exit_Reason":"SMA_Breakdown"},
      {"Entry_Date":"2025-04-16","Exit_Date":"2025-04-17","Entry_Price":197.02,"Exit_Price":196.98,"Profit":-5.73,"Return":-0.0002,"Duration":1,"Exit_Reason":"SMA_Breakdown"}
    ]
  };

  // Process trades for better visualization
  const trades = backtest_data.trades;

  // 1. Create time series from the first to last trade date
  const firstTradeDate = new Date(trades[0].Entry_Date);
  const lastTradeDate = new Date(trades[trades.length-1].Exit_Date);

  // Sort trades by exit date
  trades.sort((a, b) => new Date(a.Exit_Date) - new Date(b.Exit_Date));

  // Extract data for plotting
  const exitDates = trades.map(t => t.Exit_Date);
  const returns = trades.map(t => t.Return * 100); // Convert to percentage
  const profits = trades.map(t => t.Profit);
  const exitReasons = trades.map(t => t.Exit_Reason);

  // Prepare for hover info
  const hoverText = trades.map(t => {
    const profitColor = t.Profit >= 0 ? 'green' : 'red';
    const profitSymbol = t.Profit >= 0 ? '▲' : '▼';

    return `<b>${t.Exit_Date}</b><br>` +
           `<b style="color:${profitColor}">${profitSymbol} $${Math.abs(t.Profit).toFixed(2)}</b> (${(t.Return*100).toFixed(2)}%)<br>` +
           `Entry: ${t.Entry_Date} at $${t.Entry_Price.toFixed(2)}<br>` +
           `Exit: ${t.Exit_Date} at $${t.Exit_Price.toFixed(2)}<br>` +
           `Duration: ${t.Duration} day${t.Duration > 1 ? 's' : ''}<br>` +
           `Exit Reason: ${t.Exit_Reason || 'Not specified'}`;
  });

  // Calculate cumulative returns properly
  let cumulativeReturns = [];
  let portfolioValue = backtest_data.backtest_summary.initial_value;
  let cumulativeValues = [portfolioValue];

  // Create more accurate timeline for smoother chart
  const datesSorted = [...new Set(trades.map(t => t.Exit_Date))].sort();

  // Create an array to track cumulative portfolio value
  let valueByDate = {};
  valueByDate[datesSorted[0]] = portfolioValue;

  // Calculate cumulative portfolio value after each trade
  for (let i = 0; i < trades.length; i++) {
    portfolioValue += trades[i].Profit;
    cumulativeValues.push(portfolioValue);
    valueByDate[trades[i].Exit_Date] = portfolioValue;
  }

  // Create full timeline array
  const allDates = datesSorted;
  const portfolioValues = allDates.map(date => valueByDate[date] || null);

  // Calculate daily returns for volatility
  const dailyReturns = [];
  for (let i = 1; i < portfolioValues.length; i++) {
    if (portfolioValues[i] && portfolioValues[i-1]) {
      dailyReturns.push((portfolioValues[i] / portfolioValues[i-1]) - 1);
    }
  }

  // Separate winning and losing trades for better visualization
  const winningTrades = trades.filter(t => t.Profit > 0);
  const losingTrades = trades.filter(t => t.Profit <= 0);

  // Create traces for Plotly - more visually appealing
  const portfolioTrace = {
    x: allDates,
    y: portfolioValues,
    mode: 'lines',
    name: 'Portfolio Value ($)',
    line: {
      color: 'rgba(33, 150, 243, 0.8)',
      width: 2,
      shape: 'spline'
    },
    yaxis: 'y1',
    hovertemplate: '$%{y:,.2f}<extra></extra>'
  };

  // Design more visually appealing traces for winning and losing trades
  const winTrace = {
    x: winningTrades.map(t => t.Exit_Date),
    y: winningTrades.map(t => t.Return * 100),
    mode: 'markers',
    name: 'Winning Trades',
    marker: {
      symbol: 'circle',
      size: winningTrades.map(t => Math.min(Math.max(Math.abs(t.Profit)/150 + 5, 5), 12)),
      color: '#4CAF50',
      line: {width: 1, color: 'white'},
      opacity: 0.75
    },
    text: winningTrades.map((t, i) => hoverText[trades.findIndex(tr => tr === t)]),
    hoverinfo: 'text',
    yaxis: 'y2'
  };

  const lossTrace = {
    x: losingTrades.map(t => t.Exit_Date),
    y: losingTrades.map(t => t.Return * 100),
    mode: 'markers',
    name: 'Losing Trades',
    marker: {
      symbol: 'circle',
      size: losingTrades.map(t => Math.min(Math.max(Math.abs(t.Profit)/150 + 5, 5), 12)),
      color: '#F44336',
      line: {width: 1, color: 'white'},
      opacity: 0.75
    },
    text: losingTrades.map((t, i) => hoverText[trades.findIndex(tr => tr === t)]),
    hoverinfo: 'text',
    yaxis: 'y2'
  };

  // Highlight top 5 best and worst trades
  const bestTrades = [...trades].sort((a, b) => b.Profit - a.Profit).slice(0, 5);
  const worstTrades = [...trades].sort((a, b) => a.Profit - b.Profit).slice(0, 5);

  const bestTradesTrace = {
    x: bestTrades.map(t => t.Exit_Date),
    y: bestTrades.map(t => t.Return * 100),
    mode: 'markers',
    name: 'Top 5 Best',
    marker: {
      symbol: 'star',
      size: 12,
      color: '#FFC107',
      line: {width: 1.5, color: '#4CAF50'},
      opacity: 0.9
    },
    text: bestTrades.map(t => hoverText[trades.findIndex(tr => tr === t)]),
    hoverinfo: 'text',
    yaxis: 'y2'
  };

  const worstTradesTrace = {
    x: worstTrades.map(t => t.Exit_Date),
    y: worstTrades.map(t => t.Return * 100),
    mode: 'markers',
    name: 'Top 5 Worst',
    marker: {
      symbol: 'x',
      size: 12,
      color: '#9C27B0',
      line: {width: 1.5, color: '#F44336'},
      opacity: 0.9
    },
    text: worstTrades.map(t => hoverText[trades.findIndex(tr => tr === t)]),
    hoverinfo: 'text',
    yaxis: 'y2'
  };

  // 增加一个解释性文本说明不同元素表示什么
  const addTraceInfoAnnotation = {
    text: '<span style="font-size:9px;color:#777;line-height:1.3;">' +
          '● Blue line: Portfolio value<br>' +
          '● Green dots: Profitable trades<br>' +
          '● Red dots: Loss trades<br>' +
          '★ Yellow stars: Best trades<br>' +
          '✕ Purple X: Worst trades</span>',
    align: 'left',
    showarrow: false,
    xref: 'paper',
    yref: 'paper',
    x: 0.01,
    y: 0.99,
    bordercolor: '#e8e8e8',
    borderwidth: 1,
    borderpad: 4,
    bgcolor: 'rgba(255, 255, 255, 0.9)',
    opacity: 0.95,
    font: { family: 'Segoe UI, Roboto, sans-serif', size: 10 }
  };

  // Create a more attractive layout
  const layout = {
    title: {
      text: '',  // Removed title
      font: { size: 18, color: '#2c3e50', family: 'Segoe UI, Roboto, sans-serif' },
      y: 0.98
    },
    height: 500,
    margin: { l: 50, r: 50, t: 40, b: 60 },
    plot_bgcolor: '#ffffff',
    paper_bgcolor: '#ffffff',
    grid: { rows: 1, columns: 1, pattern: 'independent' },
    legend: {
      orientation: 'h',
      yanchor: 'bottom',
      y: 1.12,  // 增加高度防止图例和图表重叠
      xanchor: 'center',
      x: 0.5,
      font: { size: 11 },
      bgcolor: 'rgba(255,255,255,0.8)',
      bordercolor: '#E2E2E2',
      borderwidth: 1,
      itemsizing: 'constant',
      itemwidth: 30,
      tracegroupgap: 10
    },
    xaxis: {
      title: {
        text: '',  // Removed axis title
        font: { size: 12, family: 'Segoe UI, Roboto, sans-serif', color: '#2c3e50' }
      },
      rangeselector: {
        buttons: [
          {count: 3, label: '3m', step: 'month', stepmode: 'backward'},
          {count: 6, label: '6m', step: 'month', stepmode: 'backward'},
          {count: 1, label: '1y', step: 'year', stepmode: 'backward'},
          {step: 'all', label: 'All'}
        ],
        bgcolor: '#ffffff',
        activecolor: '#e6f7ff',
        font: { size: 10 }
      },
      rangeslider: {visible: true, thickness: 0.04},
      type: 'date',
      gridcolor: '#f5f5f5'
    },
    yaxis: {
      title: {
        text: 'Portfolio Value',
        font: { size: 12, family: 'Segoe UI, Roboto, sans-serif', color: '#2c3e50' }
      },
      side: 'left',
      showgrid: true,
      gridcolor: '#f5f5f5',
      zeroline: true,
      zerolinecolor: '#e0e0e0',
      tickprefix: '$',
      hoverformat: ',.2f',
      tickfont: { size: 10 }
    },
    yaxis2: {
      title: {
        text: 'Return %',
        font: { size: 12, family: 'Segoe UI, Roboto, sans-serif', color: '#2c3e50' }
      },
      side: 'right',
      overlaying: 'y',
      showgrid: false,
      zeroline: true,
      zerolinecolor: '#e0e0e0',
      ticksuffix: '%',
      hoverformat: '.2f',
      tickfont: { size: 10 }
    },
    shapes: [{
      type: 'line',
      x0: allDates[0],
      y0: 0,
      x1: allDates[allDates.length-1],
      y1: 0,
      xref: 'x',
      yref: 'y2',
      line: {
        color: 'rgba(0,0,0,0.2)',
        width: 1,
        dash: 'dot'
      }
    }],
    annotations: [{
      text: '<b>Interactive:</b> Zoom, filter, hover for details',
      align: 'left',
      showarrow: false,
      xref: 'paper',
      yref: 'paper',
      x: 0.01,
      y: 0.01,
      bordercolor: '#e2e2e2',
      borderwidth: 1,
      borderpad: 4,
      bgcolor: 'rgba(255, 255, 255, 0.8)',
      opacity: 0.9,
      font: { family: 'Segoe UI, Roboto, sans-serif', size: 10 }
    }, addTraceInfoAnnotation],
    hovermode: 'closest'
  };

  // Create the plot with enhanced styling
  Plotly.newPlot('tradingChart', [portfolioTrace, winTrace, lossTrace, bestTradesTrace, worstTradesTrace], layout, {
    responsive: true,
    displayModeBar: false,  // Hide the mode bar for cleaner UI
    displaylogo: false
  });

  // Calculate additional statistics
  const totalWins = winningTrades.length;
  const totalLosses = losingTrades.length;
  const winRate = (totalWins / trades.length * 100).toFixed(2);
  const averageWin = (winningTrades.reduce((sum, t) => sum + t.Profit, 0) / totalWins).toFixed(2);
  const averageLoss = (losingTrades.reduce((sum, t) => sum + t.Profit, 0) / totalLosses).toFixed(2);
  const largestWin = Math.max(...trades.map(t => t.Profit)).toFixed(2);
  const largestLoss = Math.min(...trades.map(t => t.Profit)).toFixed(2);
  const avgDuration = (trades.reduce((sum, t) => sum + t.Duration, 0) / trades.length).toFixed(1);

  // Calculate other risk metrics
  const annualizedReturn = ((Math.pow((backtest_data.backtest_summary.final_value / backtest_data.backtest_summary.initial_value), (365 / ((new Date(lastTradeDate) - new Date(firstTradeDate)) / (1000 * 60 * 60 * 24)))) - 1) * 100).toFixed(2);
  const dailyVolatility = (Math.sqrt(dailyReturns.reduce((sum, r) => sum + Math.pow(r, 2), 0) / dailyReturns.length) * 100).toFixed(2);
  const annualizedVolatility = (dailyVolatility * Math.sqrt(252)).toFixed(2);
  const sharpeRatio = (annualizedReturn / annualizedVolatility).toFixed(2);

  // Add summary statistics to the dashboard
  document.getElementById('summaryStat').innerHTML = `
    <div style="display:flex;flex-wrap:wrap;gap:6px;">
      <div style="flex:1;min-width:80px;">
        <div style="font-size:11px;color:#718096;">Initial Capital</div>
        <div style="font-weight:600;color:#2d3748;">$${backtest_data.backtest_summary.initial_value.toLocaleString()}</div>
      </div>
      <div style="flex:1;min-width:80px;">
        <div style="font-size:11px;color:#718096;">Final Value</div>
        <div style="font-weight:600;color:#2d3748;">$${Math.round(backtest_data.backtest_summary.final_value).toLocaleString()}</div>
      </div>
      <div style="flex:1;min-width:80px;">
        <div style="font-size:11px;color:#718096;">Total Return</div>
        <div style="font-weight:600;color:#2d3748;">${backtest_data.backtest_summary.total_return_pct.toFixed(2)}%</div>
      </div>
    </div>
    <hr style="margin:6px 0;border:0;border-top:1px solid #edf2f7;">
    <div style="display:flex;flex-wrap:wrap;gap:6px;">
      <div style="flex:1;min-width:80px;">
        <div style="font-size:11px;color:#718096;">Win Rate</div>
        <div style="font-weight:600;color:#2d3748;">${winRate}%</div>
      </div>
      <div style="flex:1;min-width:80px;">
        <div style="font-size:11px;color:#718096;">Trades</div>
        <div style="font-weight:600;color:#2d3748;">${backtest_data.backtest_summary.total_trades}</div>
      </div>
      <div style="flex:1;min-width:80px;">
        <div style="font-size:11px;color:#718096;">Avg Duration</div>
        <div style="font-weight:600;color:#2d3748;">${avgDuration} days</div>
      </div>
    </div>
    <hr style="margin:6px 0;border:0;border-top:1px solid #edf2f7;">
    <div style="display:flex;flex-wrap:wrap;gap:6px;">
      <div style="flex:1;min-width:80px;">
        <div style="font-size:11px;color:#718096;">Ann. Return</div>
        <div style="font-weight:600;color:#2d3748;">${annualizedReturn}%</div>
      </div>
      <div style="flex:1;min-width:80px;">
        <div style="font-size:11px;color:#718096;">Ann. Volatility</div>
        <div style="font-weight:600;color:#2d3748;">${annualizedVolatility}%</div>
      </div>
      <div style="flex:1;min-width:80px;">
        <div style="font-size:11px;color:#718096;">Sharpe Ratio</div>
        <div style="font-weight:600;color:#2d3748;">${sharpeRatio}</div>
      </div>
    </div>
  `;

  // Add best and worst trades to the dashboard
  document.getElementById('extremeTrades').innerHTML = `
    <div style="margin-bottom:10px;">
      <div style="font-size:12px;font-weight:600;color:#276749;margin-bottom:4px;">Top 3 Trades</div>
      ${bestTrades.slice(0, 3).map(t => `
        <div style="padding:3px 0;border-bottom:1px dotted #e2e2e2;">
          <div style="display:flex;justify-content:space-between;">
            <span style="font-size:11px;">${t.Exit_Date}</span>
            <span style="font-weight:600;color:#2f855a;">+$${t.Profit.toFixed(2)}</span>
          </div>
          <div style="display:flex;justify-content:space-between;font-size:10px;color:#718096;">
            <span>$${t.Entry_Price} → $${t.Exit_Price}</span>
            <span>${(t.Return*100).toFixed(2)}%</span>
          </div>
        </div>
      `).join('')}
    </div>
    <div>
      <div style="font-size:12px;font-weight:600;color:#c53030;margin-bottom:4px;">Worst 3 Trades</div>
      ${worstTrades.slice(0, 3).map(t => `
        <div style="padding:3px 0;border-bottom:1px dotted #e2e2e2;">
          <div style="display:flex;justify-content:space-between;">
            <span style="font-size:11px;">${t.Exit_Date}</span>
            <span style="font-weight:600;color:#c53030;">-$${Math.abs(t.Profit).toFixed(2)}</span>
          </div>
          <div style="display:flex;justify-content:space-between;font-size:10px;color:#718096;">
            <span>$${t.Entry_Price} → $${t.Exit_Price}</span>
            <span>${(t.Return*100).toFixed(2)}%</span>
          </div>
        </div>
      `).join('')}
    </div>
  `;
})();
</script>
```

This interactive dashboard provides a comprehensive view of our trading strategy's performance:

- **Portfolio Value Line**: The blue line tracks our account balance over time, showing the cumulative effect of all trades.
- **Individual Trades**: Each circle represents a completed trade, with green for profitable trades and red for losses. The size of each circle corresponds to the profit or loss amount.
- **Special Highlights**: Stars mark our top 5 most profitable trades, while X marks indicate the worst 5 trades.
- **Real-time Statistics**: Summary metrics and detailed analysis of our best and worst trades are displayed alongside the chart.

The dashboard is fully interactive - use the date range selector to focus on specific periods, hover over any trade for complete details, and click legend items to show or hide specific elements. Zoom functionality allows detailed analysis of any time period of interest.

<div style="font-size:13px;margin-top:15px;color:#4a5568;background:#f8f9fa;padding:12px;border-radius:4px;border-left:3px solid #3182ce;">
<strong style="font-size:14px;color:#2c5282;">Chart Analysis:</strong>
<p style="margin:6px 0;">
This trading chart displays the complete performance of the "Buy Low / Sell High" strategy applied to AAPL stock:
</p>
<ul style="margin:5px 0 0 0;padding-left:18px;line-height:1.4;">
  <li><strong>Blue line</strong>: Shows the portfolio value growth from initial $100,000 to final $112,885</li>
  <li><strong>Trade markers</strong>: Green dots represent profitable trades, red dots represent losing trades, with position indicating return rate</li>
  <li><strong>Special indicators</strong>: Yellow stars mark the 5 best trades (up to 15.57% return), purple X marks indicate the 5 worst trades</li>
  <li><strong>Timeline</strong>: The slider above the horizontal axis allows selection of specific time periods</li>
  <li><strong>Dual-axis design</strong>: Left Y-axis shows portfolio value (USD), right Y-axis shows individual trade returns (percentage)</li>
</ul>
<p style="margin:6px 0;">
Interactive features include: hover for trade details, time period filtering, zoom on specific areas, and toggle legend items. The right panel summarizes key strategy metrics and extreme trade records.
</p>
</div>

### Key Technical Indicators

::: {.formula-container}
::: {.formula-title}
Relative Strength Index (RSI) Calculation
:::
$$\text{RSI} = 100 - \frac{100}{1 + \frac{\text{Average Gain}}{\text{Average Loss}}}$$

Where:
- Average Gain = Average of all up moves in the look-back period
- Average Loss = Average of all down moves in the look-back period
:::

::: {.formula-container}
::: {.formula-title}
Average True Range (ATR) for Risk Management
:::
$$\text{ATR} = \frac{1}{n} \sum_{i=1}^{n} \text{TR}_i$$

$$\text{TR} = \max((\text{High} - \text{Low}), |(\text{High} - \text{Previous Close})|, |(\text{Low} - \text{Previous Close})|)$$
:::

---

::: {.section-card}
## Parameter Optimization Results {.section-title}

::: {.custom-callout}
### Optimal Parameter Combination
- RSI Threshold: 35
- ATR Stop Multiplier: 2.0
- ATR Take Multiplier: 5.0
- Sharpe Ratio: 0.95 (best value)
:::

::: {.formula-container}
::: {.formula-title}
Dynamic Stop Loss & Take Profit Calculation
:::
$$\text{Stop Loss} = \text{Entry Price} - \text{ATR} \times \text{Stop Multiplier}$$
$$\text{Take Profit} = \text{Entry Price} + \text{ATR} \times \text{Take Multiplier}$$
:::

::: {.panel-tabset}
## Performance by RSI Threshold

<!-- 表格已移除 -->

## Trading Signals

| Date       | Action | Price  | Reason                        | Outcome | Profit/Loss | Return |
|:----------:|:------:|:------:|:-----------------------------:|:-------:|:-----------:|:------:|
| 2025-04-16 | Buy    | $197.02| RSI below threshold (41.6)    | Loss    | <span class="negative-value">-$5.73</span> | <span class="negative-value">-0.02%</span> |
| 2025-04-14 | Buy    | $201.76| RSI below threshold (45.7)    | Win     | <span class="positive-value">$53.13</span> | <span class="positive-value">0.19%</span> |
| 2025-04-10 | Buy    | $186.10| RSI below threshold (38.3)    | Win     | <span class="positive-value">$1797.46</span> | <span class="positive-value">6.48%</span> |
| 2025-04-08 | Buy    | $172.06| RSI below threshold (20.0)    | Win     | <span class="positive-value">$4160.32</span> | <span class="positive-value">15.57%</span> |
| 2025-04-04 | Buy    | $177.21| RSI below threshold (25.2)    | Win     | <span class="positive-value">$637.00</span> | <span class="positive-value">2.40%</span> |
| 2025-04-02 | Buy    | $205.53| RSI below threshold (49.0)    | Loss    | <span class="negative-value">-$303.26</span> | <span class="negative-value">-1.14%</span> |
| 2025-03-31 | Buy    | $219.87| RSI below threshold (46.8)    | Win     | <span class="positive-value">$400.69</span> | <span class="positive-value">1.51%</span> |

## Exit Reasons

| Exit Reason | Trades | Percentage | Win Rate | Average Profit | Total Profit | Average Return |
|:-----------:|:------:|:----------:|:--------:|:--------------:|:------------:|:--------------:|
| RSI Overbought | 19 | 8.6% | <span class="positive-value">94.7%</span> | <span class="positive-value">$295.84</span> | <span class="positive-value">$5,620.91</span> | <span class="positive-value">1.2%</span> |
| SMA Breakdown | 106 | 47.7% | <span class="positive-value">49.1%</span> | <span class="positive-value">$64.34</span> | <span class="positive-value">$6,820.07</span> | <span class="positive-value">0.2%</span> |
| Unknown | 97 | 43.7% | <span class="positive-value">54.6%</span> | <span class="positive-value">$4.57</span> | <span class="positive-value">$443.65</span> | <span class="positive-value">0.0%</span> |

::: {.callout-tip}
## Detailed Trade Analysis
- Total Trades: 222
- Win Rate: 55.41%
- Average Profit: <span class="positive-value">$58.04</span>
- Average Win: <span class="positive-value">$284.53</span>
- Average Loss: <span class="negative-value">-$223.36</span>
- Profit Factor: 1.58
- Maximum Consecutive Wins: 7
- Maximum Consecutive Losses: 6
- Average Holding Period: 1.5 days

### Exit Reason Analysis
- **RSI Overbought**: 19 trades (8.6%), Win Rate: <span class="positive-value">94.7%</span>, Average Profit: <span class="positive-value">$295.84</span>, Total Profit: <span class="positive-value">$5,620.91</span>, Average Return: <span class="positive-value">1.2%</span>
- **SMA Breakdown**: 106 trades (47.7%), Win Rate: <span class="positive-value">49.1%</span>, Average Profit: <span class="positive-value">$64.34</span>, Total Profit: <span class="positive-value">$6,820.07</span>, Average Return: <span class="positive-value">0.2%</span>
- **Unknown**: 97 trades (43.7%), Win Rate: <span class="positive-value">54.6%</span>, Average Profit: <span class="positive-value">$4.57</span>, Total Profit: <span class="positive-value">$443.65</span>, Average Return: <span class="positive-value">0.0%</span>
:::
:::

::: {.image-container}
![Trading Strategy Visualization](AAPL_trading_signals.png)

::: {.image-caption}
*Figure 1: Trading signals with price and RSI indicators. The upper panel shows AAPL price over 24 months with key technical indicators (SMA20, SMA50, SMA200) and Bollinger Bands. Buy signals (green triangles) appear when RSI drops below 35 and price is near support levels. The lower panel shows RSI with clear oversold areas (below 40) and overbought areas (above 70), with frequent trading activity occurring as RSI oscillates between these zones.*
:::
:::

::: {.image-container}
![Portfolio Performance](AAPL_portfolio_performance.png)

::: {.image-caption}
*Figure 2: Portfolio value, drawdown and monthly returns. The top panel shows portfolio value growing from $100,000 to $112,885 with green (buy) and red (sell) triangles marking all trades. The middle panel shows drawdowns with a maximum of -2.37% in July 2024, clearly marked with a red star. The bottom panel shows a monthly return heatmap with April 2025 having the highest return (6.3%), consistent with the sharp portfolio value increase visible in the top panel.*
:::
:::

::: {.formula-container}
::: {.formula-title}
Sharpe Ratio - Primary Optimization Metric
:::
$$\text{Sharpe Ratio} = \frac{R_p - R_f}{\sigma_p}$$

Where:
- $R_p$ = Portfolio's annualized return
- $R_f$ = Risk-free rate of return
- $\sigma_p$ = Portfolio's standard deviation of returns (volatility)
:::

::: {.formula-container}
::: {.formula-title}
Maximum Drawdown Calculation
:::
$$\text{Maximum Drawdown} = \min_{\forall t \in (0,T)} \left( \frac{V_t - \max_{s \in (0,t)} V_s}{\max_{s \in (0,t)} V_s} \right)$$

Where:
- $V_t$ = Portfolio value at time t
- $T$ = End of evaluation period
:::

::: {.formula-container}
::: {.formula-title}
Geometric Mean Return
:::
$$\text{Geometric Mean Return} = \left(\prod_{i=1}^{n}(1 + r_i)\right)^{1/n} - 1$$

Where:
- $r_i$ = Return for period $i$
- $n$ = Number of periods
:::

::: {.panel-tabset}
## Key Metrics

::: {.card}
| Metric                   | Strategy |
|:-------------------------|:--------:|
| Initial Capital          | $100,000  |
| Final Value              | $112,885  |
| Total Return             | <span class="positive-value">12.88%</span> |
| Annualized Return        | <span class="positive-value">6.26%</span> |
| Max Drawdown             | <span class="positive-value">2.37%</span> |
| Geometric Mean Return    | <span class="positive-value">4.28%</span> |
| Alpha                    | <span class="positive-value">2.73%</span> |
| Beta                     | 0.13      |
| Sharpe Ratio             | <span class="positive-value">0.95</span> |
| Volatility (annualized)  | <span class="positive-value">4.42%</span> |
| Calmar Ratio             | <span class="positive-value">2.64</span> |
| Win Rate                 | 55.41%    |
| Average Trade Return     | <span class="positive-value">0.26%</span> |
| Average Trades per Year  | 111.0     |
:::

## Detailed Performance Statistics

::: {.card}
```
=================================================
              PERFORMANCE STATISTICS
=================================================
Backtest Period: 2023-04-19 to 2025-04-17
Total Days: 729 (2.00 years)

Alpha (annualized): 2.73%
Beta: 0.13

Total Return: 12.88%
Annualized Return: 6.26% (arithmetic)
Geometric Mean Annual Return: 4.28%
Volatility (annualized): 4.42%
Sharpe Ratio: 0.95

Total Trades: 222
Average Trades per Year: 111.23
Average Return per Trade: 0.22%
Average Profit per Trade: $58.04
Maximum Drawdown: -2.37%
Calmar Ratio: 2.64
```

The detailed statistics output from our performance analysis system provides a comprehensive view of the strategy's behavior:

1. **Alpha & Beta**: The strategy shows a positive Alpha (2.73%) and very low Beta (0.13), suggesting strong risk-adjusted outperformance relative to the benchmark with minimal market correlation.

2. **Risk Metrics**: With annualized volatility of 4.42% and a Sharpe ratio of 0.95, the strategy demonstrates good risk-adjusted returns.

3. **Geometric Return**: The 4.28% geometric mean annual return based on compounding daily returns better represents the actual growth trajectory of the portfolio.

These metrics confirm that while the strategy's absolute return (12.88%) was modest, its risk-adjusted performance was good, with minimal drawdown and low correlation to market movements.
:::

::: {.image-container}
![Trade Analysis](AAPL_trade_analysis.png)

::: {.image-caption}
*Figure 3: Trade distribution charts. The top-left shows profit distribution with most trades clustered around smaller profits and a few exceptional trades exceeding $2,000-$4,000. The top-right shows percentage returns distribution with a positive skew. The bottom-left histogram reveals the majority of trades had a duration of just 1 day, with smaller clusters at 3 and 4 days. The bottom-right scatter plot shows that the highest returns (including the standout 15% return) occurred on 1-day trades, supporting our quick-exit approach.*
:::
:::

## Best Trade Case Analysis

::: {.card}
### Market Context
On April 8, 2025, AAPL stock had been experiencing a significant decline, falling to the $172 range from previous levels above $200. The RSI indicator had fallen to 20, extremely below our threshold of 35, indicating a deeply oversold condition. The price was -5.9% from the lower Bollinger Band, showing exceptional bearish deviation.

### Entry and Exit Details
- **Entry Date**: April 8, 2025
- **Entry Price**: $172.06
- **RSI at Entry**: 20
- **BB Status**: -5.9% from BB Lower
- **Stop Loss**: $167.46 (ATR × 2.0)
- **Take Profit**: $189.86 (ATR × 5.0)
- **Exit Date**: April 9, 2025
- **Exit Price**: $198.85
- **Exit Reason**: SMA Breakdown
- **Profit/Loss**: <span class="positive-value">$4160.32 (15.57% return)</span>

### Success Factors
This trade capitalized on a strong bullish reversal after a steep decline. The extremely low RSI (20) indicated a deeply oversold condition, making the entry timing optimal. The price moved rapidly upward the next day, well beyond the take profit target, demonstrating the effectiveness of the strategy in capturing rebounds from oversold levels.
:::

## Trade Blotter (Selection)

::: {.card}
The trade blotter shows a selection of the most significant trades from our 222 total trades over the testing period.

| Entry Date | Exit Date | Days | Entry Price | Exit Price | Shares | Profit/Loss | Return | Exit Reason |
|:----------:|:---------:|:----:|:----------:|:----------:|:------:|:-----------:|:------:|:-----------:|
| 2025-04-08 | 2025-04-09 | 1 | $172.06 | $198.85 | 155 | <span class="positive-value">$4160.32</span> | <span class="positive-value">15.57%</span> | SMA_Breakdown |
| 2025-04-10 | 2025-04-11 | 1 | $186.10 | $198.15 | 149 | <span class="positive-value">$1797.46</span> | <span class="positive-value">6.48%</span> | SMA_Breakdown |
| 2024-06-10 | 2024-06-11 | 1 | $193.69 | $207.15 | 131 | <span class="positive-value">$1771.77</span> | <span class="positive-value">6.95%</span> | RSI_Overbought |
| 2024-08-02 | 2024-08-05 | 3 | $199.09 | $209.27 | 127 | <span class="positive-value">$1298.92</span> | <span class="positive-value">5.11%</span> | SMA_Breakdown |
| 2025-03-07 | 2025-03-10 | 3 | $235.54 | $227.48 | 114 | <span class="negative-value">-$924.44</span> | <span class="negative-value">-3.42%</span> | SMA_Breakdown |
| 2024-02-01 | 2024-02-02 | 1 | $179.87 | $185.85 | 142 | <span class="positive-value">$851.60</span> | <span class="positive-value">3.32%</span> | SMA_Breakdown |
| 2025-01-27 | 2025-01-28 | 1 | $230.84 | $238.26 | 115 | <span class="positive-value">$854.12</span> | <span class="positive-value">3.21%</span> | SMA_Breakdown |
| 2024-07-31 | 2024-08-01 | 1 | $224.37 | $218.36 | 113 | <span class="negative-value">-$685.03</span> | <span class="negative-value">-2.68%</span> | Unknown |
| 2024-07-17 | 2024-07-18 | 1 | $230.14 | $224.18 | 113 | <span class="negative-value">-$673.86</span> | <span class="negative-value">-2.59%</span> | Unknown |
| 2024-08-30 | 2024-09-03 | 4 | $228.55 | $222.77 | 114 | <span class="negative-value">-$660.02</span> | <span class="negative-value">-2.53%</span> | Unknown |

The blotter analysis shows a mix of high-profit and high-loss trades. What stands out is that our largest profits often occurred during strong bounce-back days from oversold conditions, while the largest losses were typically related to unexpected trend reversals.
:::

## Account Ledger (Monthly)

::: {.card}
The account ledger shows the monthly progression of the portfolio value, cash and equity components, and performance metrics.

| Date       | Account($) | Cash($)  | Equity($) | Drawdown(%) | Return(%)  |
|:----------:|:----------:|:--------:|:---------:|:-----------:|:----------:|
| 2023-04-30 | 100000.00  | 100000.00| 0.00      | 0.00        | 0.00       |
| 2023-05-31 | 100231.38  | 75173.53 | 25057.84  | 0.00        | 0.23       |
| 2023-06-30 | 100792.17  | 100792.17| 0.00      | 0.00        | 0.79       |
| 2023-07-31 | 100447.15  | 75335.36 | 25111.79  | -0.34       | 0.45       |
| 2023-08-31 | 99762.04   | 99762.04 | 0.00      | -1.02       | -0.24      |
| 2023-09-30 | 99440.65   | 99440.65 | 0.00      | -1.34       | -0.56      |
| 2023-10-31 | 100693.09  | 75519.82 | 25173.27  | -0.10       | 0.69       |
| 2023-11-30 | 101369.93  | 101369.93| 0.00      | -0.13       | 1.37       |
| 2023-12-31 | 102030.46  | 76522.85 | 25507.62  | -0.22       | 2.03       |
| 2024-01-31 | 103311.42  | 103311.42| 0.00      | 0.00        | 3.31       |
| 2024-02-29 | 102858.82  | 77144.12 | 25714.71  | -0.62       | 2.86       |
| 2024-03-31 | 102859.13  | 102859.13| 0.00      | -0.62       | 2.86       |
| 2024-04-30 | 102183.38  | 102183.38| 0.00      | -1.27       | 2.18       |
| 2024-05-31 | 101501.07  | 76125.80 | 25375.27  | -1.93       | 1.50       |
| 2024-06-30 | 103405.77  | 103405.77| 0.00      | -0.34       | 3.41       |
| 2024-07-31 | 101611.41  | 76208.56 | 25402.85  | -2.37       | 1.61       |
| 2024-08-31 | 104393.20  | 78294.90 | 26098.30  | 0.00        | 4.39       |
| 2024-09-30 | 104062.56  | 78046.92 | 26015.64  | -0.32       | 4.06       |
| 2024-10-31 | 103561.06  | 77670.80 | 25890.27  | -0.80       | 3.56       |
| 2024-11-30 | 105105.18  | 105105.18| 0.00      | 0.00        | 5.11       |
| 2024-12-31 | 105684.45  | 79263.34 | 26421.11  | -0.51       | 5.68       |
| 2025-01-31 | 107021.24  | 80265.93 | 26755.31  | 0.00        | 7.02       |
| 2025-02-28 | 108060.51  | 81045.38 | 27015.13  | -0.09       | 8.06       |
| 2025-03-31 | 106242.44  | 79681.83 | 26560.61  | -1.77       | 6.24       |
| 2025-04-20 | 112884.63  | 112884.63| 0.00      | 0.00        | 12.88      |

The ledger shows that our strategy maintained consistent growth with modest drawdowns. The portfolio experienced its maximum drawdown of -2.37% in July 2024, but recovered strongly. The most significant growth period occurred in April 2025, where several highly profitable trades (shown in the blotter) contributed to a sharp increase in account value.
:::

---

::: {.section-card}
## Conclusions & Future Work {.section-title}

::: {.callout-note}
### Key Findings
The "Buy Low Sell High" strategy using RSI=35 as the entry signal produced a solid positive return of 12.88% over the 24-month testing period, significantly outperforming our previous configuration. The strategy demonstrated excellent risk management with a maximum drawdown of only 2.37%.

Our analysis of exit reasons revealed that RSI Overbought exits were the most profitable, yielding an average profit of $295.84 per trade compared to $64.34 for SMA Breakdown exits. This suggests that allowing trades to run until overbought conditions occur may be more profitable than exiting based on moving average breakdowns.
:::

::: {.grid}
::: {.g-col-6}
::: {.card}
**Strategy Strengths**:

- Strong positive return (12.88%)
- Good win rate (55.41%)
- Excellent risk-adjusted performance (Sharpe 0.95)
- Low drawdown (2.37%)
- Ability to capture significant price rebounds
- Clear entry and exit rules
- RSI Overbought exits yield highest profits
:::
:::

::: {.g-col-6}
::: {.card}
**Strategy Weaknesses**:

- Short average holding period (1.5 days)
- Requires active monitoring for exits
- Performance varies with market conditions
- Some exit reasons perform better than others
- Limited experience with extended bear markets
- Possible overfit to recent market conditions
:::
:::
:::

::: {.callout-tip}
### Future Improvements
1. Test with additional market regimes including extended bear markets
2. Explore adaptive ATR multipliers based on volatility conditions
3. Implement machine learning for exit signal optimization
4. Extend to multiple assets for diversification
5. Develop portfolio-level position sizing for improved risk management
6. Test alternative exit strategies to improve average holding period
7. Prioritize RSI Overbought exit signals based on their superior performance
:::
:::
</rewritten_file>